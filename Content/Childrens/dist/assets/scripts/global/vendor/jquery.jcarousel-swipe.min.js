!function (t) { "use strict"; t.jCarousel.plugin("jcarouselSwipe", { _options: { perSwipe: 1, draggable: !0, method: "scroll", swipe: !0 }, _init: function () { var t = this; this.carousel().on("jcarousel:reloadend", function () { t._reload() }) }, _create: function () { this._instance = this.carousel().data("jcarousel"), this._instance._element.css("touch-action", this._instance.vertical ? "pan-x" : "pan-y"), this._carouselOffset = this.carousel().offset()[this._instance.lt] + parseInt(this.carousel().css(this._instance.vertical ? "border-top-width" : "border-left-width")) + parseInt(this.carousel().css(this._instance.vertical ? "padding-top" : "padding-left")), this._slidesCount = this._instance.items().length, this.carousel().find("img, a").attr("draggable", !1).css("user-select", "none").on("dragstart", function (t) { t.preventDefault() }), this._destroy(), this._instance.items().length > this._instance.fullyvisible().length && this._options.swipe && this._initGestures() }, _initGestures: function () { var e, i, n, s = this, a = {}, o = {}, c = !1, r = this._instance.vertical ? "y" : "x", l = this._instance.vertical ? "x" : "y"; function h(n) { var h, u, p; n = n.originalEvent || n || window.event, o = _(n); var f = Math.abs(a[r] - o[r]), d = Math.abs(a[l] - o[l]); c && n.preventDefault(), d > 10 && d > f && !c ? t(document).off("touchmove.jcarouselSwipe mousemove.jcarouselSwipe") : (!s._instance.animating && f > 10 || c) && (h = a[r] - o[r], c || (c = !0, s._addClones(), s._currentLT = s._getListPosition(), p = s._instance.options("items"), i = (t.isFunction(p) ? p.call(s._instance) : s._instance.list().find(p)).last(), e = s._instance.rtl && !s._instance.vertical ? s._instance.dimension(s._instance.list()) - i.position()[s._instance.lt] - s._instance.clipping() : -1 * (i.position()[s._instance.lt] + s._instance.dimension(i) - s._instance.clipping())), u = "circular" === s._instance._options.wrap ? s._currentLT - h : s._instance.rtl && !s._instance.vertical ? Math.max(0, Math.min(s._currentLT - h, e)) : Math.min(0, Math.max(s._currentLT - h, e)), s._setListPosition(u + "px")) } function u(e) { e = e.originalEvent || e || window.event, o = _(e); var i = Math.abs(a[r] - o[r]), h = Math.abs(a[l] - o[l]); if (c || !s._options.draggable && i > 10 && i > h) { var u = s._getNewTarget(a[r] - o[r] > 0); u = "circular" === s._instance._options.wrap ? u.relative : u.static, n === e.target && t(e.target).on("click.disable", function (e) { e.stopImmediatePropagation(), e.stopPropagation(), e.preventDefault(), t(e.target).off("click.disable") }), "circular" === s._instance._options.wrap && (s._removeClones(), s._instance._items = null), c = !1, s._instance[s._options.method](u, function () { "circular" !== s._instance._options.wrap && (s._removeClones(), s._instance._items = null) }) } t(document).off("touchmove.jcarouselSwipe mousemove.jcarouselSwipe"), t(document).off("touchend.jcarouselSwipe touchcancel.jcarouselSwipe mouseup.jcarouselSwipe") } function _(t) { return void 0 !== t.touches && t.touches.length > 0 ? { x: t.touches[0].pageX, y: t.touches[0].pageY } : void 0 !== t.changedTouches && t.changedTouches.length > 0 ? { x: t.changedTouches[0].pageX, y: t.changedTouches[0].pageY } : void 0 !== t.pageX ? { x: t.pageX, y: t.pageY } : { x: t.clientX, y: t.clientY } } this._element.on("touchstart.jcarouselSwipe mousedown.jcarouselSwipe", function (e) { e = e.originalEvent || e || window.event, a = _(e), n = e.target || e.srcElement, s._options.draggable && !s._instance.animating && t(document).on("touchmove.jcarouselSwipe mousemove.jcarouselSwipe", h); t(document).on("touchend.jcarouselSwipe touchcancel.jcarouselSwipe mouseup.jcarouselSwipe", u) }) }, _getNewTarget: function (t) { var e, i = this._instance.target(), n = this._instance.index(i), s = 0, a = this._instance.rtl && !this._instance.vertical ? !t : t; if (this._options.draggable) for (; e = this._instance.rtl && !this._instance.vertical ? i.offset()[this._instance.lt] + this._instance.dimension(i) - (this._carouselOffset + this._instance.clipping()) : i.offset()[this._instance.lt] - this._carouselOffset, !(!i.length || t && e >= 0 || !t && e <= 0);) { if (a) { if (!(i = i.next()).length) break; n += 1 } else { if (!(i = i.prev()).length) break; n -= 1 } s++ } else n = a ? n + 1 : n - 1, s = 1; return a ? n += Math.abs(s - this._options.perSwipe * Math.ceil(s / this._options.perSwipe)) : n -= Math.abs(s - this._options.perSwipe * Math.ceil(s / this._options.perSwipe)), "first" === this._instance._options.wrap ? n = Math.min(this._slidesCount - 1, n) : "last" === this._instance._options.wrap ? n = Math.max(0, n) : this._instance._options.wrap || (n = Math.max(0, Math.min(this._slidesCount - 1, n))), { static: n %= this._slidesCount, relative: (a ? "+" : "-") + "=" + (s = this._options.perSwipe * Math.ceil(s / this._options.perSwipe)) } }, _getListPosition: function () { var t = this._instance.list(), e = t.position(); return this._instance.rtl && (e.left = t.width() + e.left - this._carousel.width()), e[this._instance.lt] }, _setListPosition: function (t) { var e = this._instance.options("transitions"), i = !!e.transforms, n = !!e.transforms3d, s = {}, a = "left" === this._instance.lt; t = t || 0, n ? s.transform = "translate3d(" + (a ? t : 0) + "," + (a ? 0 : t) + ",0)" : i ? s.transform = "translate(" + (a ? t : 0) + "," + (a ? 0 : t) + ")" : s[this._instance.lt] = t, this._instance.list().css(s) }, _addClones: function () { var e, i, n, s = this._instance, a = s.items(), o = s.first(), c = s.last(), r = s.dimension(t(window)), l = [], h = [], u = this._getListPosition(), _ = {}; if (!s._options.wrap) return !1; if ("last" !== s._options.wrap) { for (i = 0, n = 0, e = o; i < r;)0 === (e = e.prev()).length ? (n = --n < -a.length ? -1 : n, i += s.dimension(a.eq(n)), l.push(a.eq(n).clone().attr("data-jcarousel-clone", !0))) : i += s.dimension(e); u = (s.rtl ? Math.max(u, i) : Math.min(u, -i)) + "px", s._items.first().before(l.reverse()), _[s.lt] = u, s.move(_) } if ("first" !== s._options.wrap) { for (i = 0, n = -1, e = c; i < r;)0 === (e = e.next()).length ? (n = ++n > a.length - 1 ? 0 : n, i += s.dimension(a.eq(n)), h.push(a.eq(n).clone().attr("data-jcarousel-clone", !0))) : i += s.dimension(e); s._items.last().after(h) } }, _removeClones: function () { var t, e = this._instance.first().position()[this._instance.lt], i = {}; this._instance.list().find("[data-jcarousel-clone]").remove(), (t = e - this._instance.first().position()[this._instance.lt]) && (i[this._instance.lt] = this._getListPosition() + t + "px", this._instance.move(i)) }, _destroy: function () { this._element.off("touchstart.jcarouselSwipe mousedown.jcarouselSwipe"), t(document).off("touchmove.jcarouselSwipe mousemove.jcarouselSwipe touchend.jcarouselSwipe touchcancel.jcarouselSwipe mouseup.jcarouselSwipe") }, _reload: function () { this._create() } }) }(jQuery);
